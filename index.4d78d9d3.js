const e=()=>{let e=[];for(let t=0;t<x;t++){e.push([]);for(let n=0;n<b;n++)e[t].push(0)}return e},t=(e,t,n)=>{M[t][n].classList.add(`field-cell--${e}`),M[t][n].innerText=`${e}`,p[t][n]=`${e}`},n=(e,n)=>{A.emptyCells--,t(.1>Math.random()?4:2,e,n)},r=()=>{for(;A.emptyCells>=1;){let e=Math.floor(Math.random()*x);for(;p[e].includes(0);){let t=Math.floor(Math.random()*b);if(0===p[e][t])return n(e,t)}}},s=()=>{A.moves=0,A.dontAddCells.map(e=>e.classList.remove("notAdd"))},l=()=>{A.moves>0&&(r(),A.dontAddCells=[...document.querySelectorAll(".notAdd")])},o=()=>{if(!p.some(e=>e.includes(0))&&!p.some(e=>{for(let t=1;t<e.length;t++)if(e[t]===e[t-1])return!0})){for(let e=0;e<p[0].length;e++)for(let t=1;t<p.length;t++)if(p[t][e]===p[t-1][e])return;C.style.opacity=.5,q.classList.add("hidden"),S.classList.remove("hidden")}},i=(e,t,n,r,s)=>{let l=r?M[e][t]:M[t][e],o=r?M[e][n]:M[n][e],i=l.innerText,d=""+2*Number(i);r?(p[e][t]=0,p[e][n]=s?d:i):(p[t][e]=0,p[n][e]=s?d:i),s&&(o.classList.remove(`field-cell--${i}`),o.classList.add("notAdd"),A.emptyCells++,g.innerText=Number(g.innerText)+Number(d)),o.classList.add(`field-cell--${s?d:i}`),o.innerText=`${s?d:i}`,l.classList.remove(`field-cell--${i}`),l.innerText="",A.moves++,"2048"===o.innerText&&(q.classList.add("hidden"),w.classList.remove("hidden"))},d=(e,t)=>{switch(!0){case e&&t:for(let e=0;e<=v;e++)for(let t=0;t<=y;t++)if(0!==p[e][t]&&0!==t)for(let n=t-1;n>=0;n--){if(""!==M[e][n].innerText){if(M[e][n].innerText===M[e][t].innerText&&!M[e][n].classList.notAdd){i(e,t,n,!0,!0);break}t!==n+1&&i(e,t,n+1,!0,!1);break}0===n&&i(e,t,n,!0,!1)}break;case e&&!t:for(let e=0;e<=v;e++)for(let t=y;t>=0;t--)if(0!==p[e][t]&&t!==y)for(let n=t+1;n<=y;n++){if(""!==M[e][n].innerText){if(M[e][n].innerText===M[e][t].innerText&&!M[e][n].classList.notAdd){i(e,t,n,!0,!0);break}t!==n-1&&i(e,t,n-1,!0,!1);break}n===y&&i(e,t,n,!0,!1)}break;case!e&&t:for(let e=0;e<=y;e++)for(let t=0;t<=v;t++)if(0!==p[t][e]&&0!==t)for(let n=t-1;n>=0;n--){if(""!==M[n][e].innerText){if(M[n][e].innerText===M[t][e].innerText&&!M[n][e].classList.notAdd){i(e,t,n,!1,!0);break}t!==n+1&&i(e,t,n+1,!1,!1);break}0===n&&i(e,t,n,!1,!1)}break;case!e&&!t:for(let e=0;e<=y;e++)for(let t=v;t>=0;t--)if(0!==p[t][e]&&t!==v)for(let n=t+1;n<=v;n++){if(""!==M[n][e].innerText){if(M[n][e].innerText===M[t][e].innerText&&!M[n][e].classList.notAdd){i(e,t,n,!1,!0);break}t!==n-1&&i(e,t,n-1,!1,!1);break}n===v&&i(e,t,n,!1,!1)}break;default:console.log("Some problem with counting...")}};function c(){s(),d(!0,!0),l(),o()}function a(){s(),d(!0,!1),l(),o()}function f(){s(),d(!1,!1),l(),o()}function u(){s(),d(!1,!0),l(),o()}let m=null,h=null;function L(e){let t=(e.touches||e.originalEvent.touches)[0];m=t.clientX,h=t.clientY}function T(e){if(!m||!h)return;let t=e.touches[0].clientX,n=e.touches[0].clientY,r=m-t,s=h-n;Math.abs(r)>Math.abs(s)?r>0?c():a():s>0?f():u(),m=null,h=null}const x=4,b=4,v=3,y=3;let p=e();const A={emptyCells:x*b,moves:1,dontAddCells:[]},k=document.querySelector(".button"),g=document.querySelector(".game-score"),S=document.querySelector(".message-lose"),w=document.querySelector(".message-win"),q=document.querySelector(".message-start"),C=document.querySelector(".game-field"),M=[];[...document.querySelector("tbody").children].forEach(e=>{M.push([...e.children])}),k.addEventListener("click",()=>{"Restart"===k.innerText&&(A.moves=1,A.emptyCells=x*b,g.innerHTML=0,C.style.opacity=1,M.map(e=>e.map(e=>{e.removeAttribute("class"),e.innerText="",e.classList.add("field-cell")})),p=e(),r(),r()),"Start"===k.innerText&&(r(),r(),k.innerText="Restart",k.classList.remove("start"),k.classList.add("restart"),q.innerText='Press "Restart" to new game',document.addEventListener("keyup",e=>{"ArrowLeft"===e.code&&c(),"ArrowRight"===e.code&&a(),"ArrowDown"===e.code&&f(),"ArrowUp"===e.code&&u()}),document.addEventListener("touchstart",L,!1),document.addEventListener("touchmove",T,!1)),w.classList.add("hidden"),S.classList.add("hidden"),q.classList.remove("hidden")});
//# sourceMappingURL=index.4d78d9d3.js.map
